<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Register Art & Design Fest</title>

    <!-- favicon -->
    <link rel="shortcut icon" type="image/png" href="./3r3h-logo.jpg" />

    <!-- style sheet -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:ital,wght@0,200;0,300;0,400;0,500;0,600;0,700;0,800;1,200;1,300;1,400;1,500;1,600;1,700;1,800&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700;800;900&display=swap"
      rel="stylesheet"
    />

    <!-- jquery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>

    <style>
      @import url("https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap");

      body {
        font-family: "Roboto", sans-serif;
        overflow-x: hidden;
      }

      h1,
      h2,
      h3,
      h4,
      h5,
      h6,
      p,
      span,
      div,
      label,
      input,
      textarea,
      button {
        font-family: "Roboto", sans-serif;
      }

      /* Input and placeholder styles */
      input,
      textarea {
        font-size: 0.875rem !important; /* 14px */
        font-weight: 400 !important;
      }

      input::placeholder,
      textarea::placeholder {
        font-size: 0.875rem !important; /* 14px */
        font-weight: 300 !important;
        color: #6b7280 !important;
      }

      .font-playfair {
        font-family: "Playfair Display", serif;
      }

      /* Theme colors */
      :root {
        --theme-gradient: linear-gradient(to right, #711117, #88672a);
        --theme-from: #711117;
        --theme-to: #88672a;
      }

      .bg-theme-maroon {
        background-color: #711117;
      }

      .text-theme-maroon {
        color: #711117;
      }

      .hover\:bg-theme-maroon:hover {
        background-color: #711117;
      }

      .hover\:text-theme-maroon:hover {
        color: #711117;
      }

      .bg-theme-golden {
        background-color: #88672a;
      }

      .text-theme-golden {
        color: #88672a;
      }

      .hover\:bg-theme-golden:hover {
        background-color: #88672a;
      }

      .hover\:text-theme-golden:hover {
        color: #88672a;
      }

      .bg-theme-golden-light {
        background-color: #f4b528;
      }

      .text-theme-golden-light {
        color: #f4b528;
      }

      .focus\:ring-theme-golden-light:focus {
        --tw-ring-color: #f4b528;
      }

      .border-theme-maroon {
        border-color: #711117;
      }

      .card-hover {
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      }

      .card-hover:hover {
        transform: translateY(-8px);
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.12);
      }

      .theme-button {
        background: var(--theme-gradient);
        color: white;
        transition: all 0.3s ease;
      }

      .theme-button:hover {
        transform: translateY(-2px);
        box-shadow: 0 10px 20px rgba(113, 17, 23, 0.2);
      }
    </style>
  </head>
  <body>
    <!-- Common Banner Section -->
    <div
      class="relative h-24 bg-cover bg-center"
      style="
        background-image: url('./campus.JPG');
        background-color: rgba(0, 0, 0, 0.5);
        background-blend-mode: multiply;
      "
    >
      <!-- Banner Content -->
      <div
        class="absolute inset-0 flex flex-col items-center justify-center text-white px-4"
      >
        <h1
          class="text-xl sm:text-2xl md:text-3xl lg:text-4xl font-bold mb-2 bg-clip-text text-transparent bg-gradient-to-r from-[#ed1c24] via-[#f4b528] to-[#1caf71] text-center max-w-3xl mx-auto"
        >
          3R to 3H to 3A Educational Confluence
        </h1>
        <p class="text-xs sm:text-sm text-white">2K25</p>
      </div>

      <!-- Logo straddling banner border -->
      <a href="./index.html">
        <img
          src="./3h3rr.png"
          alt="Logo"
          class="absolute bottom-[-28px] left-8 h-20 w-20 z-10"
        />
      </a>
    </div>

    <!-- Form Container -->
    <div class="max-w-2xl mx-auto bg-white min-h-screen relative">
      <!-- Registration Form (formerly Step 2) -->
      <div id="registration-form" class="p-8 pt-8">
        <h2 class="text-l font-bold mb-6 text-[#711117] text-center">
          Contextual, Relevant & Experiential Higher Education
        </h2>
        <form class="space-y-6" id="eduCon">
          <div class="grid grid-cols-1 gap-6">
            <div>
              <label class="block text-gray-700 text-xs font-bold mb-1"
                >Name <span class="text-red-500">*</span></label
              >
              <input
                type="text"
                name="name"
                required
                class="w-full px-3 py-1.5 border rounded-lg focus:ring-2 focus:ring-[#f4b528]"
              />
            </div>

            <div>
              <label class="block text-gray-700 text-xs font-bold mb-1"
                >Profession <span class="text-red-500">*</span></label
              >
              <input
                type="text"
                name="profession"
                required
                class="w-full px-3 py-1.5 border rounded-lg focus:ring-2 focus:ring-[#f4b528]"
              />
            </div>

            <div>
              <label class="block text-gray-700 text-xs font-bold mb-1"
                >Company / Organization</label
              >
              <input
                type="text"
                name="company"
                placeholder="(If Any)"
                class="w-full px-3 py-1.5 border rounded-lg focus:ring-2 focus:ring-[#f4b528]"
              />
            </div>

            <div>
              <label class="block text-gray-700 text-xs font-bold mb-1"
                >Phone Number <span class="text-red-500">*</span></label
              >
              <input
                type="tel"
                name="phone"
                required
                class="w-full px-3 py-1.5 border rounded-lg focus:ring-2 focus:ring-[#f4b528]"
              />
            </div>

            <div>
              <label class="block text-gray-700 text-xs font-bold mb-1"
                >E-mail Address <span class="text-red-500">*</span></label
              >
              <input
                type="email"
                name="email"
                required
                class="w-full px-3 py-1.5 border rounded-lg focus:ring-2 focus:ring-[#f4b528]"
              />
            </div>

            <div>
              <label class="block text-gray-700 text-xs font-bold mb-1"
                >Address <span class="text-red-500">*</span></label
              >
              <input
                type="text"
                name="address"
                required
                class="w-full px-3 py-1.5 border rounded-lg focus:ring-2 focus:ring-[#f4b528]"
              />
            </div>
          </div>

          <div class="border-t border-gray-200 pt-6 mt-6">
            <div class="mb-6">
              <p class="text-lg font-semibold">
                Get <span class="text-[#711117] font-bold">20% off</span> for
                groups of 4 or more participants
              </p>
            </div>

            <div class="mb-6">
              <label class="block text-gray-700 text-xs font-bold mb-3"
                >How will you be participating in this event?
                <span class="text-red-500">*</span></label
              >
              <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div
                  class="border rounded-lg p-4 flex items-center cursor-pointer hover:border-[#711117]"
                  onclick="selectParticipationType('individual')"
                >
                  <div
                    class="w-8 h-8 rounded-full bg-gray-200 flex items-center justify-center mr-3 text-gray-700"
                  >
                    A
                  </div>
                  <span>Individual</span>
                  <input
                    type="radio"
                    name="participation_type"
                    value="individual"
                    class="ml-auto"
                    required
                  />
                </div>
                <div
                  class="border rounded-lg p-4 flex items-center cursor-pointer hover:border-[#711117] border-[#711117]"
                  onclick="selectParticipationType('group')"
                >
                  <div
                    class="w-8 h-8 rounded-full bg-[#711117] flex items-center justify-center mr-3 text-white"
                  >
                    B
                  </div>
                  <span>In a group</span>
                  <input
                    type="radio"
                    name="participation_type"
                    value="group"
                    class="ml-auto"
                    checked
                    required
                  />
                </div>
              </div>
            </div>

            <div id="group-participants-section" class="mb-6">
              <div class="mb-4">
                <label class="block text-gray-700 text-xs font-bold mb-1"
                  >Number of Participants
                  <span class="text-red-500">*</span></label
                >
                <input
                  type="number"
                  name="participant_count"
                  min="2"
                  placeholder="Enter number of participants"
                  class="w-full px-3 py-1.5 border rounded-lg focus:ring-2 focus:ring-[#f4b528]"
                  required
                />
              </div>
              <label class="block text-gray-700 text-xs font-bold mb-3"
                >Name of remaining participants
                <span class="text-red-500">*</span></label
              >
              <textarea
                name="group_participants"
                rows="5"
                class="w-full px-3 py-1.5 border rounded-lg focus:ring-2 focus:ring-[#f4b528]"
                required
              ></textarea>
            </div>

            <div class="mb-6">
              <label class="block text-gray-700 text-xs font-bold mb-3"
                >Why do you want to participate?
                <span class="text-red-500">*</span></label
              >
              <textarea
                name="participation_reason"
                rows="5"
                class="w-full px-3 py-1.5 border rounded-lg focus:ring-2 focus:ring-[#f4b528]"
                required
              ></textarea>
            </div>
          </div>

          <div>
            <label class="block text-gray-700 text-xs font-bold mb-2"
              >Upload Photo <span class="text-red-500">*</span></label
            >
            <div class="flex items-center justify-center w-full">
              <label
                name="photo"
                class="flex flex-col items-center px-4 py-6 bg-white text-[#88672a] rounded-lg shadow-lg tracking-wide border border-[#711117] cursor-pointer hover:bg-gray-50"
              >
                <svg
                  class="w-8 h-8"
                  fill="currentColor"
                  xmlns="http://www.w3.org/2000/svg"
                  viewBox="0 0 20 20"
                >
                  <path
                    d="M16.88 9.1A4 4 0 0 1 16 17H5a5 5 0 0 1-1-9.9V7a3 3 0 0 1 4.52-2.59A4.98 4.98 0 0 1 17 8c0 .38-.04.74-.12 1.1zM11 11h3l-4-4-4 4h3v3h2v-3z"
                  />
                </svg>
                <span class="mt-2 text-sm">Select file</span>
                <input
                  type="file"
                  name="photo"
                  class="hidden"
                  required
                  accept="image/*"
                />
              </label>
            </div>
          </div>

          <button
            type="button"
            onclick="validateAndProceed()"
            class="w-full bg-gradient-to-r from-[#711117] to-[#88672a] hover:from-[#88672a] hover:to-[#711117] text-white font-bold py-3 px-8 rounded-lg transition-all duration-300 shadow-lg hover:shadow-xl transform hover:scale-105"
          >
            Proceed to Payment
          </button>
        </form>
      </div>

      <!-- Payment Page (formerly Step 3) -->
      <div id="step3" class="hidden p-8 pt-16">
        <div class="text-center mb-8">
          <!-- Back Button -->
          <button
            onclick="goBack()"
            class="back-btn relative flex items-center text-[#711117] hover:text-[#88672a] transition"
          >
            <svg
              class="arrow w-6 h-6 mr-1 transition-transform"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M10 19l-7-7m0 0l7-7m-7 7h18"
              />
            </svg>
            Back
          </button>
          <h2 class="text-2xl font-bold mb-4 text-[#711117]">
            Complete Your Payment
          </h2>

          <div class="bg-gray-100 p-6 rounded-lg mb-6">
            <p class="font-semibold mb-4">UPI ID: conference@bank</p>
            <div
              class="mx-auto w-48 h-48 mb-6 bg-white p-4 rounded-lg shadow-md flex items-center justify-center"
            >
              <img
                src="./3h3rr.png"
                alt="QR Code"
                class="max-w-full max-h-full"
              />
            </div>

            <div class="space-y-4">
              <div class="mb-4">
                <label class="block text-gray-700 text-sm font-bold mb-2"
                  >Select Accommodation Type
                  <span class="text-red-500">*</span></label
                >
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                  <div
                    class="border rounded-lg p-4 flex items-center cursor-pointer hover:border-[#711117]"
                    onclick="selectAccommodationType('single')"
                  >
                    <div
                      class="w-8 h-8 rounded-full bg-gray-200 flex items-center justify-center mr-3 text-gray-700"
                    >
                      S
                    </div>
                    <span>Single Occupancy</span>
                    <input
                      type="radio"
                      name="accommodation_type"
                      value="single"
                      class="ml-auto"
                      required
                    />
                  </div>
                  <div
                    class="border rounded-lg p-4 flex items-center cursor-pointer hover:border-[#711117]"
                    onclick="selectAccommodationType('double')"
                  >
                    <div
                      class="w-8 h-8 rounded-full bg-gray-200 flex items-center justify-center mr-3 text-gray-700"
                    >
                      D
                    </div>
                    <span>Double Occupancy</span>
                    <input
                      type="radio"
                      name="accommodation_type"
                      value="double"
                      class="ml-auto"
                      required
                    />
                  </div>
                </div>
              </div>

              <!-- Amount Display Section -->
              <div
                id="amount-display"
                class="hidden bg-white p-4 rounded-lg border-2 border-[#711117] mb-4"
              >
                <div class="space-y-2">
                  <div class="flex justify-between items-center">
                    <span class="font-semibold">Base Amount:</span>
                    <span id="base-amount">₹0</span>
                  </div>
                  <div
                    id="discount-row"
                    class="flex justify-between items-center text-green-600 hidden"
                  >
                    <span class="font-semibold">Group Discount (20%):</span>
                    <span id="discount-amount">-₹0</span>
                  </div>
                  <div
                    class="flex justify-between items-center pt-2 border-t border-gray-200"
                  >
                    <span class="font-bold text-lg">Total Amount:</span>
                    <span
                      id="total-amount"
                      class="font-bold text-lg text-[#711117]"
                      >₹0</span
                    >
                  </div>
                </div>
              </div>

              <input
                type="text"
                name="transaction_id"
                placeholder="Transaction ID"
                required
                class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-[#711117]"
              />

              <div
                class="border-dashed border-2 border-gray-300 p-4 rounded-lg"
              >
                <label class="block text-gray-600 mb-2"
                  >Upload Payment Screenshot
                  <span class="text-red-500">*</span></label
                >
                <input
                  type="file"
                  name="payment_screenshot"
                  class="w-full"
                  required
                  accept="image/*"
                />
              </div>
            </div>
          </div>

          <button
            type="button"
            onclick="validatePaymentAndProceed()"
            class="bg-gradient-to-r from-[#711117] to-[#88672a] hover:from-[#88672a] hover:to-[#711117] text-white font-bold py-3 px-8 rounded-lg transition-all duration-300 shadow-lg hover:shadow-xl transform hover:scale-105"
          >
            Submit Payment
          </button>
        </div>
      </div>

      <!-- Thank You Page (formerly Step 4) -->
      <div id="step4" class="hidden p-8 pt-16">
        <h2 class="text-3xl font-bold mb-6 text-[#711117]">
          Thank You for Registering! 🎉
        </h2>

        <div class="bg-gray-100 p-6 rounded-lg mb-8">
          <div class="grid grid-cols-1 md:grid-cols-3 gap-6 text-left">
            <div>
              <h3 class="font-bold mb-2 text-[#711117]">When?</h3>
              <p>May 23rd, 2025</p>
            </div>
            <div>
              <h3 class="font-bold mb-2 text-[#711117]">Where?</h3>
              <p>HIAL, Phyang, Ladakh</p>
            </div>
            <!-- Direction -->

            <div>
              <h3 class="font-bold mb-2 text-[#711117]">Direction?</h3>
              <div class="flex items-center justify-start space-x-2">
                <a
                  href="https://maps.app.goo.gl/UM3qaRYxLoyLHFjG6"
                  target="_blank"
                  class="text-[#88672a] hover:text-[#711117] transition-colors"
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    class="h-6 w-6 cursor-pointer"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke="currentColor"
                    title="Open in Google Maps"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"
                    />
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"
                    />
                  </svg>
                </a>
                <span>Here</span>
              </div>
            </div>
          </div>
        </div>

        <div class="space-y-4">
          <h3 class="text-xl font-semibold text-[#711117]">Stay Updated</h3>
          <div class="flex justify-center space-x-6">
            <a href="#" class="text-[#88672a] hover:text-[#711117]"
              >Instagram</a
            >
            <a href="#" class="text-[#88672a] hover:text-[#711117]"
              >LinkedIn Event</a
            >
          </div>
        </div>
      </div>
    </div>

    <script>
      /* Script for back and forth page button */
      let currentStep = 2; // Start at step 2 (registration form)

      function nextStep(step) {
        currentStep = step;
        if (currentStep === 2) {
          document
            .getElementById("registration-form")
            .classList.remove("hidden");
          document.getElementById("step3").classList.add("hidden");
          document.getElementById("step4").classList.add("hidden");
        } else {
          document.getElementById("registration-form").classList.add("hidden");
          document.getElementById("step3").classList.add("hidden");
          document.getElementById("step4").classList.add("hidden");
          document.getElementById(`step${step}`).classList.remove("hidden");
        }
      }

      function goBack() {
        if (currentStep > 2) {
          currentStep--;
          if (currentStep === 2) {
            document
              .getElementById("registration-form")
              .classList.remove("hidden");
            document.getElementById("step3").classList.add("hidden");
            document.getElementById("step4").classList.add("hidden");
          } else {
            document
              .getElementById("registration-form")
              .classList.add("hidden");
            document.getElementById("step3").classList.add("hidden");
            document.getElementById("step4").classList.add("hidden");
            document
              .getElementById(`step${currentStep}`)
              .classList.remove("hidden");
          }
        }
      }

      /* Script for Posting data to google sheet */
      async function submitFormToGoogleSheets() {
        const form = document.getElementById("eduCon");

        // Show loading state
        const submitButton = document.querySelector(
          'button[onclick="validatePaymentAndProceed()"]'
        );
        const originalButtonText = submitButton.textContent;
        submitButton.textContent = "Submitting...";
        submitButton.disabled = true;

        // Get all form data
        const formData = {
          name: form.querySelector('input[name="name"]').value,
          profession: form.querySelector('input[name="profession"]').value,
          company: form.querySelector('input[name="company"]').value,
          phone: form.querySelector('input[name="phone"]').value,
          email: form.querySelector('input[name="email"]').value,
          address: form.querySelector('input[name="address"]').value,
          participation_type: form.querySelector(
            'input[name="participation_type"]:checked'
          ).value,
          participant_count:
            form.querySelector('input[name="participant_count"]')?.value || "1",
          group_participants:
            form.querySelector('textarea[name="group_participants"]')?.value ||
            "",
          participation_reason: form.querySelector(
            'textarea[name="participation_reason"]'
          ).value,
          accommodation_type:
            form.querySelector('input[name="accommodation_type"]:checked')
              ?.value || "",
          transaction_id:
            form.querySelector('input[name="transaction_id"]')?.value || "",
          total_amount:
            document.getElementById("total-amount")?.textContent || "₹0",
        };

        try {
          console.log("Submitting form data:", formData);

          const response = await fetch(
            "https://script.google.com/macros/s/AKfycbzRfXk4ImD_pGPVyn3SUhbXpMkronKWQysVGZlXaj8edohevmoshuDxcXINGw3DEVCZYw/exec",
            {
              method: "POST",
              headers: {
                "Content-Type": "application/json",
              },
              body: JSON.stringify(formData),
              mode: "cors",
              redirect: "follow",
            }
          );

          console.log("Response status:", response.status);

          // Check if response is ok
          if (!response.ok) {
            throw new Error(`HTTP error! Status: ${response.status}`);
          }

          const responseText = await response.text();
          console.log("Response text:", responseText);

          let result;
          try {
            result = JSON.parse(responseText);
          } catch (e) {
            console.error("Error parsing JSON:", e);
            throw new Error("Invalid response format");
          }

          if (result.result === "success") {
            // Reset form and proceed to thank you page
            form.reset();
            nextStep(4);
          } else {
            throw new Error(result.error || "Submission failed");
          }
        } catch (error) {
          console.error("Error:", error);
          alert(
            "Error submitting form. Please try again or contact support.\n\nDetails: " +
              error.message
          );
          // Reset button state
          submitButton.textContent = originalButtonText;
          submitButton.disabled = false;
        }
      }

      /* Script for participation type selection */
      function selectParticipationType(type) {
        const individualOption = document.querySelector(
          'input[value="individual"]'
        );
        const groupOption = document.querySelector('input[value="group"]');
        const groupParticipantsSection = document.getElementById(
          "group-participants-section"
        );
        const participantCountInput = document.querySelector(
          'input[name="participant_count"]'
        );
        const groupParticipantsTextarea = document.querySelector(
          'textarea[name="group_participants"]'
        );

        // Update radio button states
        individualOption.checked = type === "individual";
        groupOption.checked = type === "group";

        // Update visual styles for individual option
        const individualParent = individualOption.parentElement;
        const individualIcon = individualParent.querySelector("div");
        individualParent.classList.toggle(
          "border-[#711117]",
          type === "individual"
        );
        individualIcon.classList.toggle("bg-[#711117]", type === "individual");
        individualIcon.classList.toggle("text-white", type === "individual");
        individualIcon.classList.toggle("bg-gray-200", type !== "individual");
        individualIcon.classList.toggle("text-gray-700", type !== "individual");

        // Update visual styles for group option
        const groupParent = groupOption.parentElement;
        const groupIcon = groupParent.querySelector("div");
        groupParent.classList.toggle("border-[#711117]", type === "group");
        groupIcon.classList.toggle("bg-[#711117]", type === "group");
        groupIcon.classList.toggle("text-white", type === "group");
        groupIcon.classList.toggle("bg-gray-200", type !== "group");
        groupIcon.classList.toggle("text-gray-700", type !== "group");

        // Show/hide group participants section
        if (type === "individual") {
          groupParticipantsSection.style.display = "none";
          participantCountInput.removeAttribute("required");
          groupParticipantsTextarea.removeAttribute("required");
        } else {
          groupParticipantsSection.style.display = "block";
          participantCountInput.setAttribute("required", "required");
          groupParticipantsTextarea.setAttribute("required", "required");
        }

        // Update amount calculation
        calculateAmount();
      }

      // Initialize participation type on page load
      document.addEventListener("DOMContentLoaded", function () {
        selectParticipationType("group"); // Default to group option
      });

      /* Constants for pricing */
      const PRICES = {
        single: 45000, // Base price for single occupancy (₹45,000)
        double: 35000, // Base price for double occupancy (₹35,000)
        groupDiscountThreshold: 4, // Minimum participants for group discount
        groupDiscountPercentage: 0.2, // 20% discount for groups
      };

      /* Script for accommodation type selection */
      function selectAccommodationType(type) {
        const singleOption = document.querySelector('input[value="single"]');
        const doubleOption = document.querySelector('input[value="double"]');

        if (type === "single") {
          singleOption.checked = true;
          doubleOption.checked = false;
          singleOption.parentElement.classList.add("border-[#711117]");
          doubleOption.parentElement.classList.remove("border-[#711117]");
          singleOption.parentElement
            .querySelector("div")
            .classList.add("bg-[#711117]", "text-white");
          singleOption.parentElement
            .querySelector("div")
            .classList.remove("bg-gray-200", "text-gray-700");
          doubleOption.parentElement
            .querySelector("div")
            .classList.add("bg-gray-200", "text-gray-700");
          doubleOption.parentElement
            .querySelector("div")
            .classList.remove("bg-[#711117]", "text-white");
        } else {
          singleOption.checked = false;
          doubleOption.checked = true;
          doubleOption.parentElement.classList.add("border-[#711117]");
          singleOption.parentElement.classList.remove("border-[#711117]");
          doubleOption.parentElement
            .querySelector("div")
            .classList.add("bg-[#711117]", "text-white");
          doubleOption.parentElement
            .querySelector("div")
            .classList.remove("bg-gray-200", "text-gray-700");
          singleOption.parentElement
            .querySelector("div")
            .classList.add("bg-gray-200", "text-gray-700");
          singleOption.parentElement
            .querySelector("div")
            .classList.remove("bg-[#711117]", "text-white");
        }

        calculateAmount();
      }

      /* Function to calculate and display amount */
      function calculateAmount() {
        const participationType = document.querySelector(
          'input[name="participation_type"]:checked'
        ).value;
        const accommodationType = document.querySelector(
          'input[name="accommodation_type"]:checked'
        )?.value;
        const participantCount =
          document.querySelector('input[name="participant_count"]')?.value || 1;

        if (!accommodationType) return;

        const amountDisplay = document.getElementById("amount-display");
        const baseAmountElement = document.getElementById("base-amount");
        const discountRow = document.getElementById("discount-row");
        const discountAmountElement =
          document.getElementById("discount-amount");
        const totalAmountElement = document.getElementById("total-amount");

        // Calculate base amount
        const basePrice = PRICES[accommodationType];
        const baseAmount = basePrice * participantCount;

        // Calculate discount if applicable
        let discount = 0;
        if (
          participationType === "group" &&
          participantCount >= PRICES.groupDiscountThreshold
        ) {
          discount = baseAmount * PRICES.groupDiscountPercentage;
          discountRow.classList.remove("hidden");
        } else {
          discountRow.classList.add("hidden");
        }

        // Calculate total
        const totalAmount = baseAmount - discount;

        // Update display
        amountDisplay.classList.remove("hidden");
        baseAmountElement.textContent = `₹${baseAmount.toLocaleString()}`;
        discountAmountElement.textContent = `-₹${discount.toLocaleString()}`;
        totalAmountElement.textContent = `₹${totalAmount.toLocaleString()}`;
      }

      // Add event listener for participant count changes
      document
        .querySelector('input[name="participant_count"]')
        ?.addEventListener("input", calculateAmount);

      /* Form validation function */
      function validateAndProceed() {
        // Get all required fields
        const name = document.querySelector('input[name="name"]').value.trim();
        const profession = document
          .querySelector('input[name="profession"]')
          .value.trim();
        const phone = document
          .querySelector('input[name="phone"]')
          .value.trim();
        const email = document
          .querySelector('input[name="email"]')
          .value.trim();
        const address = document
          .querySelector('input[name="address"]')
          .value.trim();
        const participationType = document.querySelector(
          'input[name="participation_type"]:checked'
        ).value;
        const photo = document.querySelector('input[type="file"]').files[0];

        // Validation messages
        let errorMessage = "";

        // Basic validation
        if (!name) errorMessage += "Please enter your name.\n";
        if (!profession) errorMessage += "Please enter your profession.\n";
        if (!phone) errorMessage += "Please enter your phone number.\n";
        if (!email) errorMessage += "Please enter your email address.\n";
        if (!address) errorMessage += "Please enter your address.\n";
        if (!photo) errorMessage += "Please upload a photo.\n";

        // Email validation
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        if (email && !emailRegex.test(email)) {
          errorMessage += "Please enter a valid email address.\n";
        }

        // Phone validation (basic)
        const phoneRegex = /^\d{10}$/;
        if (phone && !phoneRegex.test(phone)) {
          errorMessage += "Please enter a valid 10-digit phone number.\n";
        }

        // Group specific validation
        if (participationType === "group") {
          const participantCount = document.querySelector(
            'input[name="participant_count"]'
          ).value;
          const groupParticipants = document
            .querySelector('textarea[name="group_participants"]')
            .value.trim();

          if (!participantCount || participantCount < 2) {
            errorMessage +=
              "Please enter number of participants (minimum 2).\n";
          }
          if (!groupParticipants) {
            errorMessage += "Please enter names of remaining participants.\n";
          }
        }

        // Check participation reason
        const participationReason = document
          .querySelector('textarea[name="participation_reason"]')
          .value.trim();
        if (!participationReason) {
          errorMessage += "Please enter your reason for participation.\n";
        }

        // If there are errors, show them
        if (errorMessage) {
          alert("Please fix the following errors:\n\n" + errorMessage);
          return;
        }

        // If validation passes, proceed to next step
        nextStep(3);
      }

      // Update file input to show selected file name
      document
        .querySelector('input[type="file"]')
        .addEventListener("change", function (e) {
          const fileName = e.target.files[0]?.name;
          const fileLabel = this.parentElement.querySelector("span");
          if (fileName) {
            fileLabel.textContent = fileName;
          } else {
            fileLabel.textContent = "Select file";
          }
        });

      /* Payment validation function */
      function validatePaymentAndProceed() {
        // Get all required fields
        const accommodationType = document.querySelector(
          'input[name="accommodation_type"]:checked'
        )?.value;
        const transactionId = document
          .querySelector('input[name="transaction_id"]')
          .value.trim();
        const paymentScreenshot = document.querySelector(
          'input[name="payment_screenshot"]'
        ).files[0];

        // Validation messages
        let errorMessage = "";

        // Validate accommodation type
        if (!accommodationType) {
          errorMessage += "Please select an accommodation type.\n";
        }

        // Validate transaction ID
        if (!transactionId) {
          errorMessage += "Please enter the transaction ID.\n";
        } else if (transactionId.length < 8) {
          errorMessage +=
            "Transaction ID should be at least 8 characters long.\n";
        }

        // Validate payment screenshot
        if (!paymentScreenshot) {
          errorMessage += "Please upload the payment screenshot.\n";
        }

        // If there are errors, show them
        if (errorMessage) {
          alert("Please fix the following errors:\n\n" + errorMessage);
          return;
        }

        // Submit form data to Google Sheets
        submitFormToGoogleSheets();
      }

      // Update payment screenshot file input to show selected file name
      document
        .querySelector('input[name="payment_screenshot"]')
        .addEventListener("change", function (e) {
          const fileName = e.target.files[0]?.name;
          if (fileName) {
            this.parentElement.querySelector(
              "label"
            ).textContent = `Selected: ${fileName}`;
          } else {
            this.parentElement.querySelector("label").textContent =
              "Upload Payment Screenshot *";
          }
        });
    </script>
  </body>
</html>
